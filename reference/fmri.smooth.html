<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Smoothing Statistical Parametric Maps — fmri.smooth • fmri</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Smoothing Statistical Parametric Maps — fmri.smooth" />
<meta property="og:description" content="Perform the adaptive weights smoothing procedure" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmri</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Smoothing Statistical Parametric Maps</h1>
    
    <div class="hidden name"><code>fmri.smooth.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform the adaptive weights smoothing procedure</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>fmri.smooth</span><span class='op'>(</span><span class='va'>spm</span>, hmax <span class='op'>=</span> <span class='fl'>4</span>, adaptation<span class='op'>=</span><span class='st'>"aws"</span>,
            lkern<span class='op'>=</span><span class='st'>"Gaussian"</span>, skern<span class='op'>=</span><span class='st'>"Plateau"</span>, weighted<span class='op'>=</span><span class='cn'>TRUE</span>,<span class='va'>...</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spm</th>
      <td><p>object of class <code>fmrispm</code></p></td>
    </tr>
    <tr>
      <th>hmax</th>
      <td><p>maximum bandwidth to smooth</p></td>
    </tr>
    <tr>
      <th>adaptation</th>
      <td><p>character, type of adaptation. If <code>"none"</code> adaptation is off and non-adaptive 
  kernel smoothing with <code>lkern</code> and bandwidth <code>hmax</code> is used. 
  Other values are <code>"aws"</code> for adaptive smoothing using an approximative correction term for spatial smoothness in the penalty (fast), <code>"fullaws"</code> for adaptive smoothing using variance
  estimates from smoothed residuals in the penalty (CPU-time about twice 
  the time compared to <code>adaptation="aws"</code> and <code>"segment"</code> for a
  new approach based on segmentation using multi-scale tests.</p></td>
    </tr>
    <tr>
      <th>lkern</th>
      <td><p><code>lkern</code> specifies the location kernel. Defaults to
    "Gaussian", other choices are "Triangle" and "Plateau". Note that the location kernel is applied to
    <code>(x-x_j)^2/h^2</code>, i.e. the use of "Triangle" corresponds to the
    Epanechnicov kernel in nonparametric kernel regression. "Plateau" specifies a kernel that is equal to 1 in the interval (0,.3),
    decays linearly in (.5,1) and is 0 for arguments larger than 1.</p></td>
    </tr>
    <tr>
      <th>skern</th>
      <td><p><code>skern</code> specifies the kernel for the statistical
    penalty. Defaults to "Plateau", the alternatives are "Triangle" and "Exp".
    "Plateau" specifies a kernel that is equal to 1 in the interval (0,.3),
    decays linearly in (.3,1) and is 0 for arguments larger than 1.
    <code>lkern="Plateau"</code> and <code>lkern="Triangle"</code> allow for much faster computation (saves up
    to 50% CPU-time). <code>lkern="Plateau"</code> produces a less random weighting scheme.</p></td>
    </tr>
    <tr>
      <th>weighted</th>
      <td><p><code>weighted</code> (logical) determines if weights contain the inverse of local 
   variances as a factor (Weighted Least Squares). <code>weighted=FALSE</code> does not employ the
   heteroscedasticity of variances for the weighting scheme and is preferable if variance estimates
   are highly variable, e.g. for short time series.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further internal arguments for the smoothing algorithm usually not
    to be set by the user. Allows e.g. for parameter adjustments by
    simulation using our propagation condition. Usefull exceptions
    can be used for <code>adaptation="segment"</code>: Specifically
    <code>alpha</code> (default 0.05) defines the significance level for the
    signal detection. It can be choosen between 0.01 and 0.2 as for
    other values we did not determine the critical values for the
    statistical tests. <code>delta</code> (default 0) defines the minimum
    signal which should be detected. 
    <code>restricted</code> determines if smoothing for voxel detected to be significant is restricted to use only voxel from the same segment. The 
    default is <code>restricted=FALSE</code>. <code>restricted</code> slighty changes 
    the behaviour under the altenative, i.e. not the interpretation of results.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function performs the smoothing on the Statistical Parametric Map
  spm.</p>
<p><code>hmax</code> is the (maximal) bandwidth used in the last iteration. Choose
  <code>adaptation</code> as <code>"none"</code> for non adaptive
  smoothing. <code>lkern</code> can be used for specifying the
  localization kernel. For comparison with non adaptive methods use
  "Gaussian" (hmax times the voxelsize in x-direction will give the FWHM bandwidth in mm), 
  for better adaptation use "Plateau" or "Triangle"
  (default, hmax given in voxel). For <code>lkern="Plateau"</code> and <code>lkern="Triangle"</code> thresholds may be inaccurate, due to a violation of
    the Gaussian random field assumption under homogeneity. <code>lkern="Plateau"</code> 
    is expected to provide best results with adaptive smoothing.</p>   
<p><code>skern</code> can be used for specifying the
  kernel for the statistical penalty. "Plateau" is expected to provide the best results,
  due to a less random weighting scheme.</p>
<p>The function handles zero variances by assigning a large value (1e20)
  to these variances. Smoothing is restricted to voxel with <code>spm$mask</code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>object with class attributes "fmrispm" and "fmridata", or "fmrisegment" and "fmridata" for segmentation choice</p>
<dt>cbeta</dt><dd><p>smoothed parameter estimate</p></dd>
  <dt>var</dt><dd><p>variance of the parameter</p></dd>
  <dt>hmax</dt><dd><p>maximum bandwidth used</p></dd>
  <dt>rxyz</dt><dd><p>smoothness in resel space. all directions</p></dd>
  <dt>rxyz0</dt><dd><p>smoothness in resel space as would be achieved by
    a Gaussian filter with the same bandwidth. all directions</p></dd>
  <dt>scorr</dt><dd><p>array of spatial correlations with maximal lags 5, 5, 3 in x,y and z-direction.</p></dd>
  <dt>bw</dt><dd><p>vector of bandwidths (in FWHM) corresponding to the spatial correlation within the data.</p></dd>
  <dt>dim</dt><dd><p>dimension of the data cube and residuals</p></dd>
  <dt>weights</dt><dd><p>ratio of voxel dimensions</p></dd>
  <dt>vwghts</dt><dd><p>ratio of estimated variances for the stimuli given by
  <code>vvector</code></p></dd>
  <dt>hrf</dt><dd><p>Expected BOLD response for the specified effect</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Polzehl, J., Voss, H.U., and Tabelow, K. (2010).
   <em>Structural Adaptive Segmentation for Statistical Parametric Mapping</em>,
   NeuroImage, 52:515-523.</p>
<p>Tabelow, K., Polzehl, J., Voss, H.U., and Spokoiny, V. (2006). 
<em>Analysing fMRI
    experiments with structure adaptive smoothing procedures</em>,
  NeuroImage, 33:55-62.</p>
<p>Polzehl, J. and Spokoiny, V. (2006). <em>Propagation-Separation
    Approach for Local Likelihood Estimation</em>, Probab. Theory
  Relat. Fields 135:335-362.</p>
<p>Polzehl, J. and Tabelow, K. (2007)
  <em>fmri: A Package for Analyzing fmri Data</em>,
  R News, 7:13-17 .</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Joerg Polzehl <a href='mailto:polzehl@wias-berlin.de'>polzehl@wias-berlin.de</a>,
  Karsten Tabelow <a href='mailto:tabelow@wias-berlin.de'>tabelow@wias-berlin.de</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>fmri.smooth</span><span class='op'>(</span><span class='va'>spm</span>, hmax <span class='op'>=</span> <span class='fl'>4</span>, lkern <span class='op'>=</span> <span class='st'>"Gaussian"</span><span class='op'>)</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Karsten Tabelow, Joerg Polzehl.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


