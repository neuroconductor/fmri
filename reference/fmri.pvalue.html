<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>P-values — fmri.pvalue • fmri</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="P-values — fmri.pvalue" />
<meta property="og:description" content="Determine p-values." />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmri</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.9.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>P-values</h1>
    
    <div class="hidden name"><code>fmri.pvalue.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Determine p-values.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>fmri.pvalue</span><span class='op'>(</span><span class='va'>spm</span>, mode<span class='op'>=</span><span class='st'>"basic"</span>, na.rm<span class='op'>=</span><span class='cn'>FALSE</span>, minimum.signal <span class='op'>=</span> <span class='fl'>0</span>, alpha<span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>spm</th>
      <td><p><code>fmrispm</code> object</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>type of pvalue definition</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p><code>na.rm</code> specifies how NA's in the SPM are handled. NA's may occur
   in voxel where the time series information did not allow for estimating parameters and their variances
   or where the time series information where constant over time. A high (1e19) value of the variance
   and a parameter of 0 are used to characterize NA's. If <code>na.rm=TRUE</code> the pvalue for the corresponding voxels
   is set to 1. Otehrwise pvalues are assigned according to the information found in the SPM at the voxel.</p></td>
    </tr>
    <tr>
      <th>minimum.signal</th>
      <td><p>allows to specify a (positive) minimum value for detected signals. If minimum.signal &gt;0
   the thresholds are to conservative, this case needs further improvements.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Significance level in case of <code>mode="FDR"</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If only a contrast is given in <code>spm</code>, we simply use a t-statistic
  and define p-values according to random field theory for the resulting gaussian
  field (sufficiently large number of df - see ref.). If <code>spm</code> is a
  vector of length larger than one for each voxel, a chisq field is
  calculated and evaluated (see
  Worsley and Taylor (2006)). If <code>delta</code> is given, a cone statistics is
  used.</p>
<p>The parameter <code>mode</code> allows for different kinds of p-value
  calculation. <code>mode="voxelwise"</code> refers to voxelwise tests while
  <code>mode="Bonferroni"</code> adjusts the significance level for multiple testing.
  An alternative is <code>mode="FDR"</code> specifying signal detection by False
  Discovery Rate (FDR) with proportion of false positives level specified by <code>alpha</code>.
  The other choices apply results on excursion sets of random fields
  (Worsley 1994, Adler 2003) for smoothed SPM's.
  "basic" corresponds to a global definition of the
  resel counts based on the amount of smoothness achieved by an equivalent
  Gaussian filter. The propagation condition ensures, that under the
  hypothesis
  $$\hat{\Theta} = 0$$
  adaptive smoothing performs like a
  non adaptive filter with the same kernel function which justifies this
  approach. "local"
  corresponds to a more conservative setting, where the p-value is
  derived from the estimated local resel counts that has been achieved by
  adaptive smoothing. In contrast to "basic", "global" takes a global
  median to adjust for the randomness of the weighting scheme generated
  by adaptive smoothing. "global" and "local" are more conservative than
  "basic", that is, they generate sligthly larger p-values.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Object with class attributes "fmripvalue" and "fmridata"</p>
<dt>pvalue</dt><dd><p>p-value. use with <code><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></code> for thresholding.</p></dd>
  <dt>weights</dt><dd><p>voxelsize ratio</p></dd>
  <dt>dim</dt><dd><p>data dimension</p></dd>
  <dt>hrf</dt><dd><p>expected BOLD response for contrast (single stimulus only)</p></dd>
  <dt>alpha</dt><dd><p>maximal pvalue as scale information</p></dd>
  <dt>thresh</dt><dd><p>actual threshold used</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Polzehl, J. and Tabelow, K. (2007)
  <em>fmri: A Package for Analyzing fmri Data</em>,
  R News, 7:13-17 .</p>
<p>Tabelow, K., Polzehl, J., Voss, H.U., and Spokoiny, V. (2006).
<em>Analysing fMRI
    experiments with structure adaptive smoothing procedures</em>,
  NeuroImage, 33:55-62.</p>
<p>Worsley, K.J., and Taylor, J.E., <em>Detecting fMRI activation
    allowing for unknown latency of the hemodynamic response</em>,
  NeuroImage 29:649-654 (2006).</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Karsten Tabelow <a href='mailto:tabelow@wias-berlin.de'>tabelow@wias-berlin.de</a></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Unexpected side effects may occur if spm does not meet the
  requirements, especially if a parameter estimate vector of length greater than 2 through
  argument <code>vvector</code> in <code><a href='fmri.lm.html'>fmri.lm</a></code> has beeen produced for every voxel.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='fmri.lm.html'>fmri.lm</a></code>,  <code><a href='fmri.smooth.html'>fmri.smooth</a></code>, <code><a href='plot.fmridata.html'>plot.fmridata</a></code>,
<code><a href='fmri.cluster.html'>fmri.cluster</a></code>, <code><a href='fmri.searchlight.html'>fmri.searchlight</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='fu'>fmri.pvalue</span><span class='op'>(</span><span class='va'>smoothresult</span><span class='op'>)</span></span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Karsten Tabelow, Joerg Polzehl.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>


